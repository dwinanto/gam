<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <link rel="preload" href="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js" as="script">
  <link rel="preload" href="https://www.gstatic.com/firebasejs/8.6.1/firebase-analytics.js" as="script">
  <link rel="preload" href="https://www.gstatic.com/firebasejs/8.6.1/firebase-remote-config.js" as="script">

    <script>
    window.googletag = window.googletag || { cmd: [] };

    googletag.cmd.push(function () {
      // Declare slots initially present on the page


      // Enable SRA to honor competetive exclusions and roadblocks.
      googletag.pubads().enableSingleRequest();

      // Enable services
      googletag.enableServices();
    });



  </script>
  
<style>
div.a {
  height: auto;
  border: 1px solid black;
}

div.b {
  height: 500px;
  border: 1px solid black;  
}
</style>  
</head>

<body>
  <h1>GPT Test Page - Infinite Content WandaT</h1>

  <!-- First ad -->
  <div id="welcome_message" class="b">welcome_message</div>
  
  <p>par 1</p>
  <p>par 2</p>
  <p class="baca">par 3</p>
  <p>par 4</p>

  <p id="msg"></p>

  <div id="div1" class="b">hello div 1</div>
  <div id="div2">hello div 2</div>
  <div id="div3">hello div 3</div>
  <div id="mgid">mgid</div>


  <ul>
    <li sort="1">1</li>
    <li sort="2">2</li>
    <li sort="3">3</li>
    <li sort="4">4</li>
    <li sort="5">5</li>
    <li sort="6">6</li>
    <li sort="7">7</li>
  </ul>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-remote-config.js"></script>
  <script>
    function insertAfter(referenceNode, newNode) {
      referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
    }
    // Function to add content to page
    function injectAds(targetNode) {
      googletag.cmd.push(function () {
        var slot = googletag.defineSlot('/6355419/Travel', [728, 90])
          .setTargeting('test', 'infinitescroll')
          .addService(googletag.pubads());

        var div = document.createElement('div');
        div.id = slot.getSlotElementId(); // auto-generated by GPT

        console.log('test');
        console.log(targetNode);

        insertAfter(targetNode, div);
        googletag.display(slot);
      });
    }

    var firebaseConfig = {
      apiKey: "AIzaSyB3K5WuoObzk5VfLuxvksqbVOspP-WrzEA",
      authDomain: "avengers-gold.firebaseapp.com",
      projectId: "avengers-gold",
      storageBucket: "avengers-gold.appspot.com",
      messagingSenderId: "751876414940",
      appId: "1:751876414940:web:9e48be6a618fd9ec7f8319",
      measurementId: "G-GMPTS2X81N"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const analytics = firebase.analytics();
    analytics.logEvent('notification_received', {
      content_type: 'image',
      content_id: 'P12453',
      items: [{ name: 'Kittens' }]
    });

    const remoteConfig = firebase.remoteConfig();
    remoteConfig.settings = {
      fetchTimeMillis: 60000,
      minimumFetchIntervalMillis: 30000
    }
    remoteConfig.defaultConfig = {
  "welcome_message": "Welcome Default",
      "ads_location1": "#div1 li[sort='2'] p.baca"
};

    remoteConfig.fetchAndActivate()
      .then(() => {
        const val = remoteConfig.getValue('welcome_messsage');
        const ads_location = remoteConfig.getValue('ads_location1');

        //targetlist = ["#div1", "li[sort='2']", "p.baca"];
        targetlist = ads_location._value.split(";");
        for (let i = 0; i < targetlist.length; i++) {
          console.log(targetlist[i]);
          temp_nodes = document.querySelectorAll(targetlist[i]);

          for (j = 0; j < temp_nodes.length; j++) {
            injectAds(temp_nodes[j]);
          }
        }

        console.log(val);
        console.log(ads_location);

        const welcome_element = document.getElementById('welcome_message');
        welcome_element.innerText = val._value + ' (' + val._source + ')';
      })
      .catch((err) => {
        console.error('Firebase Remote Config failed to fetch and activate', err);
      });





  </script>
</body>

</html>

id=mgid
p class=baca
li sort="1"



